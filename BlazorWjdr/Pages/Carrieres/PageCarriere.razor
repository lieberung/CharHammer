@page "/carrieres/{CarriereId}/"

@using BlazorWjdr.Components.Carriere
@using BlazorWjdr.Components.Aptitude
@using BlazorWjdr.Components.Profil

@inject CarrieresService CarrieresService
@inject AppState _appState
@code {
    [Parameter, EditorRequired] public string CarriereId { get; set; } = null!;

    private CarriereDto Item { get; set; } = null!;

    protected override void OnInitialized()
    {
        _appState.SetMainTopRowTitle("Carrière");
    }

    protected override void OnParametersSet()
    {
        Item = CarrieresService.GetCarriere(int.Parse(CarriereId));
    }
}
<div class="row">

    <div class="col-6 pe-0">
        <div class="section pt-0 pe-0">
            <h1>@Item.Nom</h1>
            <CarriereDescription Item=@Item AfficherCitations=true />
        </div>
    </div>

    <div class="col-5">
        <div class="section">
            <h4>Plan de carrière</h4>
            <p class="text-justify">
                <Profil PlanDeCarriere=@Item.PlanDeCarriere />
            </p>

            <p class="text-justify">
                <CarriereNiveau Niveau=@Item.Niveau />
                @if (Item.CompetenceDeMetier != null)
                {
                    <ItemIcon Icon="infinity" Classes="mx-3" />
                    <AptitudeItem Item=@Item.CompetenceDeMetier />
                }
                @if (Item.Statut != "")
                {
                    <ItemIcon Icon="infinity" Classes="mx-3" />
                    <Tooltip Text=@Item.SalaireHebdo>
                        <span class="insister">@Item.StatutPretty()</span>
                    </Tooltip>
                }
            </p>

            <h4>Compétences</h4>
            <p class="text-justify">
                <AptitudeItemList Items=@Item.Competences ItemsChoix=@Item.ChoixCompetences />
            </p>

            <h4>Talents</h4>
            <p class="text-justify">
                <AptitudeItemList Items=@Item.Talents ItemsChoix=@Item.ChoixTalents />
            </p>

            @if (Item.ProposeAuMoinsUnTrait)
            {
                <h4>Traits</h4>
                <p class="text-justify">
                    <AptitudeItemList Items=@Item.Traits ItemsChoix=@Item.ChoixTraits />
                </p>
            }

            <h4>Dotations</h4>
            <p class="text-justify">
                <CarriereDotations Item=@Item />
            </p>
        </div>

        <div class="section mt-2">
            <h4>Débouchés</h4>
            <p class="text-justify">
                <CarriereItemList Items=@Item.Debouches SpecialCarriereId=@Item.DebouchesDAvancements.Select(a => a.Id) />
            </p>

            <h4>Filières</h4>
            <p class="text-justify">
                @if (Item.Filieres.Any())
                {
                    <CarriereItemList Items=@Item.Filieres SpecialCarriereId=@Item.FilieresDAvancement.Select(a => a.Id) HideIndicatorRestriction=true />
                }
                @if (Item.EstUneCarriereDeBase)
                {
                    <CarriereDeBase />
                }
            </p>
            <CarriereRestriction Item=@Item />
        </div>
    </div>
</div>