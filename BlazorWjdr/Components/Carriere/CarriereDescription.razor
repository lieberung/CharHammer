@using BlazorWjdr.Models
@using BlazorWjdr.Components.Reference
@using BlazorWjdr.Components.Regle

<img class="career-img" src="@Item.Image" alt="@Item.Nom" style="max-width: 300px; max-height: 450px;"/>

@if (Item.Avancement != null)
{
    <p class="card-text">
        <CarriereAvancement Carriere="@Item.Avancement"/>
    </p>
}

@foreach (var paragraphe in _paragraphes)
{
    <p class="card-text pr-3" style="text-align:justify; min-height:300px;">
        @paragraphe
    </p>
}
@if (AfficherCitations && Item.Ambiance.Any())
{
    <CarriereCitations Items="@Item.Ambiance"/>
}
@if (Item.SourceLivre != null || !string.IsNullOrWhiteSpace(Item.Source))
{
    <ReferenceItem Item="@Item.SourceLivre" Page="@Item.Source"/>
}
@code{
    [Parameter]
    public CarriereDto Item { get; set; } = null!;
    [Parameter]
    public bool AfficherCitations { get; set; }
    
    private string[] _paragraphes = null!;

    protected override void OnParametersSet()
    {
        _paragraphes = Item.Description
            .Replace('\r', '\n')
            .Replace("\n\n", "\n")
            .Split('\n');
        base.OnParametersSet();
    }
}